MinesGame={currentBet:0,currentProfit:0,currentAction:null,take:function(e){MinesGame.currentProfit=e,MinesGame.add(),MinesGame.currentAction="stake"},play:function(e){MinesGame.currentBet=e,MinesGame.deduct(),MinesGame.currentAction="play"},add:function(){const e=$("#game_id").attr("data-game-id"),t={winnings:MinesGame.currentProfit,game_id:e};MinesGame.sendXHR("/api/balance/add","POST",t)},deduct:function(){const e=$("#game_id").attr("data-game-id"),t={bet:MinesGame.currentBet,game_id:e};MinesGame.sendXHR("/api/balance/deduct","PUT",t)},takeCallback:function(e){$("#money").html(e.new_balance),$("#money").attr("data-current-balance",e.new_balance),$("#money_update").html("+$"+parseFloat(MinesGame.currentProfit).toFixed(2)),$("#div_money_update").css("display","block"),$("#money_update").css("color","yellow");let t=setInterval(function(){this.div_money_update.style.display="none",clearInterval(t)},3e3)},deductCallBack:function(e){if(200===e.status){$("#money").html(e.new_balance),$("#money").attr("data-current-balance",e.new_balance),$("#money_update").html("-$"+parseFloat(MinesGame.currentBet).toFixed(2)),$("#div_money_update").css("display","block"),$("#money_update").css("color","red");let t=setInterval(function(){this.div_money_update.style.display="none",clearInterval(t)},3e3)}else MinesGame.currentBet=0,MinesGame.currentProfit=0,$("#_payin").click()},sendXHR:function(e,t,n){const a=new XMLHttpRequest,s=$("meta[name=csrf-token]").attr("content");a.open(t,e),a.setRequestHeader("Content-Type","appication/json"),a.setRequestHeader("X-CSRF-TOKEN",s),a.setRequestHeader("Authorization","Bearer "+s),a.onload=(()=>{a.status>=200&&a.status<300?"play"==MinesGame.currentAction?MinesGame.deductCallBack(JSON.parse(a.responseText)):MinesGame.takeCallback(JSON.parse(a.responseText)):console.log(new Error(a.statusText))}),a.send(JSON.stringify(n))}};
